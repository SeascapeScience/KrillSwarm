title: "Notebook08 - smoothing splines"
output: html_notebook
---

```{r}
rm(list=ls(all=TRUE))
load("C:\\Users\\Nicole Hellessey\\Documents\\Post-doc\\Data\\Total Merged Data File (July 12 2022).Rdata")
```

Remove ends of tank and clean data

```{r}
#### cut 1cm from each axis to get rid of edge effect
#### gives us only what's happening in center of tank 
### gives us defined segments to spline

## start by getting rid of front and back of tank 

CC.TotalData$trim.X <- CC.TotalData$X
CC.TotalData$trim.X[CC.TotalData$trim.X<.06] <- NA
CC.TotalData$trim.X[CC.TotalData$trim.X>0.3] <- NA
hist(CC.TotalData$trim.X)

#####################################################

range(CC.TotalData$X)
range(CC.TotalData$Y)
range(CC.TotalData$Z)

#plot(CC.TotalData$X)
#plot(CC.TotalData$X[1:542000])
#plot(CC.TotalData$X[542000:1100000])
#hist(CC.TotalData$X)
#hist(CC.TotalData$Y)
#hist(CC.TotalData$Z)

m <- mean(CC.TotalData$X[1:542000])-mean(CC.TotalData$X[542000:1112228])  ## correcting for video camera shift
m
CC.TotalData$X[542000:1112228] <- CC.TotalData$X[542000:1112228] + m

m <- min(CC.TotalData$X[542000:1112228])
CC.TotalData$X[542000:1112228] <- CC.TotalData$X[542000:1112228] - m


```
```{r}

CC.TotalData$xsmooth <- runmed(x = CC.TotalData$trim.X, k = 31, na.action = 'na.omit')  ## optimum number for smoothing (try 31 to 101)
plot(CC.TotalData$trim.X[1000:10000])
plot(CC.TotalData$xsmooth[1000:10000])

CC.TotalData$ysmooth <- runmed(x = CC.TotalData$Y, k = 31, na.action = 'na.omit')
plot(CC.TotalData$Y[1000:10000])
plot(CC.TotalData$ysmooth[1000:10000])


CC.TotalData$zsmooth <- runmed(x = CC.TotalData$Z, k = 31, na.action = 'na.omit')
plot(CC.TotalData$Z[1000:10000])
plot(CC.TotalData$zsmooth[1000:10000])


```

```{r}
rm(alldata, df, TotalData, D, d1, d2, dd, dotprod, dotx, doty, dotz, dx1, dx2, dy1, dy2, dz1, dz2, list2, list3, list4, list5, v1, v2, vx1, vx2, vy1, vy2, vz1, vz2, x1, x2, y1, y2, z1, z2)
rm(lth, l, ind, i, files)
rm(metadata, ldf)
save.image("~/Post-doc/Data/Total Merged Data File (July 12 2022).RData")
