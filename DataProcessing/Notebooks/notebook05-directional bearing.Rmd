---
title: "Directional Bearing"
output: html_notebook
---

```{r}

rm(list=ls(all=TRUE))
load("C:\\Users\\Nicole Hellessey\\Documents\\Post-doc\\Data\\Total Merged Data File (Dec 14 2021).Rdata")

## Need to use turn angles and a point of reference (e.g. inlet valve) to determine directional bearing


library(circular)   ## loads the "circular" package

head(TotalData)
str(TotalData)
## We already have pitch and heading in TotalData
##Need to remember to convert heading into degrees - use:  TotalData$heading/(2*pi)*360

## head(CC.TotalData)  Flow and Chlorophyll are numeric - need to get back to factors with correct numbers
## str(CC.TotalData)


library(ggplot2)
ggplot(TotalData,aes(x=Flow.rate, y=heading/(2*pi)*360, fill=Chlorophyll))+
  geom_boxplot(notch=F, notchwidth=0.3,outlier.shape=1,outlier.size=2, coef=1.5)+
  theme(axis.text=element_text(color="black"))+
  theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.4))+
  theme(panel.grid.minor=element_blank())+
  labs(size= "",x = "Flow Rate (cm/s)", y = "Heading (degrees)", title = "Light") +
  scale_fill_manual(values=c("greenyellow", "yellowgreen","lightgreen", "green", "green3", "green4", "darkgreen"),name = "Chlorophyll (mg/L)",
                    labels=c("0", "4.3", "4.6", "6.1", "7.6", "13.5", "19"))+
  facet_grid(~Light, scales = "free_x", space = "free")
```
```{r}
library(circular)

circ <- circular(CC.TotalData$turn.anglexy, type = c("angles"),
          units = c("degrees"),
          template = c("geographics"))

## S3 method for class 'circular'
as(circ, control.circular=list(), ...) ## NOT WORKING CURRENTLY

## S3 method for class 'circular'
is(circ)

## S3 method for class 'circular'
print(circ, info=TRUE)


## S3 method for class 'circular'
plot(circ, pch = 16, cex = 1, stack = TRUE,
axes = TRUE, start.sep=0, sep = 0.025, shrink = 3.5,
bins = 120, ticks = FALSE, tcl = 0.025, tcl.text = 0.125,
col = NULL, tol = 0.04, uin = NULL,
xlim = c(-1, 1), ylim = c(-1, 1), digits = 2, units = NULL,
template = NULL, zero = NULL, rotation = NULL,
main = NULL, sub=NULL, xlab = "", ylab = "",
control.circle=circle.control())


### need to subset data into variables to see if more manageable to make figures of

## run dataframe subset code in notebook 06 to do this (SAVED IN RMD FILE)

```


Plotting each subset of chlorophyll data in the XY plane

```{r}
circ0 <- circular(ChlA0$turn.anglexy, type = c("angles"),
          units = c("degrees"),
          template = c("geographic"))

plot(circ0, pch = 16, cex = 1, stack = TRUE,
axes = TRUE, start.sep=0, sep = 0.025, shrink = 3.5,
bins = 120, ticks = FALSE, tcl = 0.025, tcl.text = 0.125,
col = NULL, tol = 0.04, uin = NULL,
xlim = c(-1, 1), ylim = c(-1, 1), digits = 2, units = NULL,
template = NULL, zero = NULL, rotation = NULL,
main = "Chlorophyll 0mg/L", sub="Control Conditions", xlab = "", ylab = "",
control.circle=circle.control())

##  jpeg(filename= "~/Post-doc/Graphs/Notebook 05 - directional bearing/Chla 0 turn.angle xy geographic.jpeg", units = "px", width = 480, height = 480)

circ4.3 <- circular(ChlA4.3$turn.anglexy, type = c("angles"),
          units = c("degrees"),
          template = c("geographic"))

plot(circ4.3, pch = 16, cex = 1, stack = TRUE,
axes = TRUE, start.sep=0, sep = 0.025, shrink = 3.5,
bins = 120, ticks = FALSE, tcl = 0.025, tcl.text = 0.125,
col = NULL, tol = 0.04, uin = NULL,
xlim = c(-1, 1), ylim = c(-1, 1), digits = 2, units = NULL,
template = NULL, zero = NULL, rotation = NULL,
main = " Chlorophyll 4.3mg/L", sub="Chlorophyll Conditions", xlab = "", ylab = "",
control.circle=circle.control())

circ4.6 <- circular(ChlA4.6$turn.anglexy, type = c("angles"),
          units = c("degrees"),
          template = c("geographic"))

plot(circ4.6, pch = 16, cex = 1, stack = TRUE,
axes = TRUE, start.sep=0, sep = 0.025, shrink = 3.5,
bins = 120, ticks = FALSE, tcl = 0.025, tcl.text = 0.125,
col = NULL, tol = 0.04, uin = NULL,
xlim = c(-1, 1), ylim = c(-1, 1), digits = 2, units = NULL,
template = NULL, zero = NULL, rotation = NULL,
main = "Chlorophyll 4.6mg/L", sub="Chlorophyll Conditions", xlab = "", ylab = "",
control.circle=circle.control())

circ6 <- circular(ChlA6$turn.anglexy, type = c("angles"),
          units = c("degrees"),
          template = c("geographic"))

plot(circ6, pch = 16, cex = 1, stack = TRUE,
axes = TRUE, start.sep=0, sep = 0.025, shrink = 3.5,
bins = 120, ticks = FALSE, tcl = 0.025, tcl.text = 0.125,
col = NULL, tol = 0.04, uin = NULL,
xlim = c(-1, 1), ylim = c(-1, 1), digits = 2, units = NULL,
template = NULL, zero = NULL, rotation = NULL,
main = "Chlorophyll 6.1mg/L", sub="Chlorophyll Conditions", xlab = "", ylab = "",
control.circle=circle.control())

circ7 <- circular(ChlA7$turn.anglexy, type = c("angles"),
          units = c("degrees"),
          template = c("geographic"))

plot(circ7, pch = 16, cex = 1, stack = TRUE,
axes = TRUE, start.sep=0, sep = 0.025, shrink = 3.5,
bins = 120, ticks = FALSE, tcl = 0.025, tcl.text = 0.125,
col = NULL, tol = 0.04, uin = NULL,
xlim = c(-1, 1), ylim = c(-1, 1), digits = 2, units = NULL,
template = NULL, zero = NULL, rotation = NULL,
main = "Chlorophyll 7.3mg/L", sub="Chlorophyll Conditions", xlab = "", ylab = "",
control.circle=circle.control())

circ13 <- circular(ChlA13$turn.anglexy, type = c("angles"),
          units = c("degrees"),
          template = c("geographic"))

plot(circ13, pch = 16, cex = 1, stack = TRUE,
axes = TRUE, start.sep=0, sep = 0.025, shrink = 3.5,
bins = 120, ticks = FALSE, tcl = 0.025, tcl.text = 0.125,
col = NULL, tol = 0.04, uin = NULL,
xlim = c(-1, 1), ylim = c(-1, 1), digits = 2, units = NULL,
template = NULL, zero = NULL, rotation = NULL,
main = "Chorophyll 13.5mg/L", sub="Chlorophyll Conditions", xlab = "", ylab = "",
control.circle=circle.control())

circ19 <- circular(ChlA19$turn.anglexy, type = c("angles"),
          units = c("degrees"),
          template = c("geographic"))

plot(circ19, pch = 16, cex = 1, stack = TRUE,
axes = TRUE, start.sep=0, sep = 0.025, shrink = 3.5,
bins = 120, ticks = FALSE, tcl = 0.025, tcl.text = 0.125,
col = NULL, tol = 0.04, uin = NULL,
xlim = c(-1, 1), ylim = c(-1, 1), digits = 2, units = NULL,
template = NULL, zero = NULL, rotation = NULL,
main = "Chlorophyll 19.5mg/L", sub="Chlorophyll Conditions", xlab = "", ylab = "",
control.circle=circle.control())

```

Do the same again but for Flow
```{r}

```

And for Light
```{r}

```

And for Guano
```{r}

```

Save the environment and remove unneeded dataframes, lists, etc


```{r}

## how do we account for krill headings while drifting backwards?

rm(ldf)

save.image("~/Post-doc/Data/Total Merged Data File (Feb 15 2022).RData")

```


